<!DOCTYPE html>
<html lang="fr">
    {{template "InitPage" .}}
  <body>
    <!-- Header -->
    {{template "ForumHeader" .}}

     
    <!-- Main Content -->
    <main class="main-content">

      <!-- Sidebar -->
      <aside class="sidebar">
        <form method="POST">
        <h3>Profil 
          <button class="profil-edit" type="button" id="editprofil" onclick="EditProfil()" title="Modifier mon profil">üîß</button></h3>
        
        <img class="post-avatar" src="{{.User.ProfilPic}}"/><p><span id="currentimg"></span>
        <input type="text" name="newimg" value="{{.User.ProfilPic}}" id="newimg" class="is-hidden admin-input" required>
        </p>

        <p><span id="currentname">{{.User.Username}}</span>
          
          <input type="text" name="newname" maxlength="50" value="{{.User.Username}}" id="newname" class="is-hidden admin-input" required>
        </p>

        <p> <span id="currentmail">{{.User.Email}}</span>
           <input type="email" name="newmail" maxlength="50" value="{{.User.Email}}" id="newmail" class="is-hidden admin-input" required>
        </p>

        <button type="submit" name="action" value="editprofil" class="profil-btn is-hidden" id="valid-btn">‚úÖ Valider</button>
        </form>
        <p>{{.User.Status}}
          {{if eq .User.Status "Membre"}}
    <form  method="POST">
      <button type="submit" name ="action" value="requestmod" class="profil-btn">Demander √† rejoindre la mod√©ration</button>
    </form>
          {{end}}

        </p>

        <div class="profil-nav">
        <button onclick="ShowLikes()" class="profil-btn">Messages que j'ai üëç ou üëé</button>
        <button onclick="ShowPosts()" class="profil-btn">üí¨ Tous mes messages</button>
        <button onclick="ShowTopics()" class="profil-btn">üîñ Sujets que j'ai ouverts</button>
        </div>

          

      </aside>

       

      <section class="posts-section is-hidden" id="see-liked-posts">
   
      <div class="dashboard-header">
  <div class="topic-top"> <h2>Mes üëç</h2>
    
    </div></div> <br>
        {{range .LikedPosts}}
        <div class="post-card">
          <img class="post-avatar" src="{{.Author.ProfilPic}}"/>
          <div class="post-content">
            <a class="post-title" href="/topic/{{.TopicID}}">{{.TopicName}}</a>
            <span class="topic-postnumber">- Message de {{.Author.Username}} </span>
            <a class="post-text" href="/topic/{{.TopicID}}#{{.MessageID}}">{{.Content}}
            </a>
          </div>
        </div>
        {{else}}
        <div class="post-card">
          <div class="post-content">
            <div class="post-text">
              <center>Il n'y a aucun message √† afficher pour l'instant.</center>
            </div>
          </div>
        </div>
        {{end}}
        </div></section>

         <section class="posts-section is-hidden" id="see-disliked-posts">
         
      <div class="dashboard-header">
  <div class="topic-top"> <h2>Mes üëé</h2>
    </div></div> <br>
        {{range .DislikedPosts}}
        <div class="post-card">
          <img class="post-avatar" src="{{.Author.ProfilPic}}"/>
          <div class="post-content">
            <a class="post-title" href="/topic/{{.TopicID}}">{{.TopicName}}</a>
            <span class="topic-postnumber">- Message de {{.Author.Username}} </span>
            <a class="post-text" href="/topic/{{.TopicID}}#{{.MessageID}}">{{.Content}}
            </a>
          </div>
        </div>
        {{else}}
        <div class="post-card">
          <div class="post-content">
            <div class="post-text">
              <center>Il n'y a aucun message √† afficher pour l'instant.</center>
            </div>
          </div>
        </div>
        {{end}}
      </section>

      <section class="posts-section is-hidden" id="see-my-posts"><div class="dashboard-header">
  <div class="topic-top"> <h2>Tous mes messages</h2>
    </div></div><br>
        {{range .MyPosts}}
        <div class="post-card">
          <img class="post-avatar" src="{{.Author.ProfilPic}}"/>
          <div class="post-content">
            <a class="post-title" href="/topic/{{.TopicID}}">Sur le sujet : {{.TopicName}}</a>
            <a class="post-text" href="/topic/{{.TopicID}}#{{.MessageID}}">{{.Content}}
            </a>
          </div>
        </div>
        {{else}}
        <div class="post-card">
          <div class="post-content">
            <div class="post-text">
              <center>Il n'y a aucun message √† afficher pour l'instant.</center>
            </div>
          </div>
        </div>
        {{end}}
      </section>

      <section class="posts-section" id="see-my-topics"><div class="dashboard-header">
  <div class="topic-top"> <h2>Sujets que j'ai ouverts</h2>
    </div></div><br>
        {{range .Topics}}
        <div class="post-card">
          <img class="post-avatar" src="{{.Author.ProfilPic}}"/>
          <div class="post-content">
            <a class="post-title" href="/topic/{{.TopicID}}">{{.TopicName}}</a> <span class="topic-postnumber">- le {{.Created}} </span>
            <a class="post-text" href="/topic/{{.TopicID}}#{{.MessageID}}">{{.Content}}
            </a>
          </div>
        </div>
        {{else}}
        <div class="post-card">
          <div class="post-content">
            <div class="post-text">
              <center>Il n'y a aucun message √† afficher pour l'instant.</center>
            </div>
          </div>
        </div>
        {{end}}
      </section>
      
    </main>

    <script>
      // -------- Modifications du profil
      function EditProfil()  {
      const editBtn = document.getElementById("editprofil")
      const validBtn = document.getElementById("valid-btn")

      const imageInput = document.getElementById("newimg")
      const nameInput = document.getElementById("newname")
      const mailInput = document.getElementById("newmail")

      const currentName = document.getElementById("currentname")
      const currentMail = document.getElementById("currentmail")
      const currentImg = document.getElementById("currentimg")

      imageInput.classList.remove("is-hidden");
      nameInput.classList.remove("is-hidden");
      mailInput.classList.remove("is-hidden");
      validBtn.classList.remove("is-hidden");

      currentMail.innerHTML = "Modifier mon adresse mail";
      currentName.innerHTML = "Modifier mon pseudo";
      currentImg.innerHTML = "Modifier l'image";
      editBtn.classList.add("is-hidden");

      }


      // -------- Onglets du profil
      const LikedPosts = document.getElementById("see-liked-posts")
      const DislikedPosts = document.getElementById("see-disliked-posts")
      const MyPosts = document.getElementById("see-my-posts")
      const MyTopics = document.getElementById("see-my-topics")
      const ModHistory = document.getElementById("see-my-history")

      function ShowPosts() {
        MyPosts.classList.remove("is-hidden");
        MyTopics.classList.add("is-hidden");
        LikedPosts.classList.add("is-hidden");
        DislikedPosts.classList.add("is-hidden");
        ModHistory.classList.add("is-hidden");
      }
      function ShowLikes() {
        LikedPosts.classList.remove("is-hidden");
        DislikedPosts.classList.remove("is-hidden");
        MyPosts.classList.add("is-hidden");
        MyTopics.classList.add("is-hidden");
        ModHistory.classList.add("is-hidden");
      }

      function ShowTopics(){
        LikedPosts.classList.add("is-hidden");
        DislikedPosts.classList.add("is-hidden");
        MyPosts.classList.add("is-hidden");
        MyTopics.classList.remove("is-hidden");
        ModHistory.classList.add("is-hidden");
      }
    </script>
  </body>
</html>
